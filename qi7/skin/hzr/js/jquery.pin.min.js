(function(a){"use strict";a.fn.pin=function(c){var g=0,f=[],d=false,h=a(window);c=c||{};var e=function(){for(var m=0,p=f.length;m<p;m++){var q=f[m];if(c.minWidth&&h.width()<=c.minWidth){if(q.parent().is(".pin-wrapper")){q.unwrap()}q.css({width:"",left:"",top:"",position:""});if(c.activeClass){q.removeClass(c.activeClass)}d=true;continue}else{d=false}var r=c.containerSelector?q.closest(c.containerSelector):a(document.body);var l=q.offset();var n=r.offset();var o=a(c.containerFrom).offset();var j=q.offsetParent().offset();if(!q.parent().is(".pin-wrapper")){q.wrap("<div class='pin-wrapper'>")}var k=a.extend({top:0,bottom:0},c.padding||{});q.data("pin",{pad:k,from:c.containerFrom?o.top:((c.containerSelector?n.top:l.top))-k.top,to:n.top+r.height()-q.outerHeight()-k.bottom,end:n.top+r.height(),parentTop:j.top});q.css({width:q.outerWidth()});q.parent().css("height",q.outerHeight())}};var b=function(){if(d){return}g=h.scrollTop();var l=[];for(var k=0,j=f.length;k<j;k++){var n=a(f[k]),m=n.data("pin");if(!m){continue}l.push(n);var p=m.from-m.pad.bottom,o=m.to-m.pad.top;if(p+n.outerHeight()>m.end){n.css("position","");continue}if(p<g&&o>g){!(n.css("position")=="fixed")&&n.css({left:n.offset().left,top:m.pad.top}).css("position","fixed");if(c.activeClass){n.addClass(c.activeClass)}}else{if(g>=o){n.css({left:"",top:o-m.parentTop+m.pad.top}).css("position","absolute");if(c.activeClass){n.addClass(c.activeClass)}}else{n.css({position:"",top:"",left:""});if(c.activeClass){n.removeClass(c.activeClass)}}}}f=l};var i=function(){e();b()};this.each(function(){var k=a(this),j=a(this).data("pin")||{};if(j&&j.update){return}f.push(k);a("img",this).one("load",e);j.update=i;a(this).data("pin",j)});h.scroll(b);h.resize(function(){e()});e();h.load(i);return this}})(jQuery);